
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Partyservice Kleinfeldt – Auftragsplaner V10</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background-color: #f5f5f5; padding: 20px; max-width: 1000px; margin: auto; }
    h1 { color: #222; }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input, select, textarea {
      padding: 8px; margin-top: 5px; margin-bottom: 10px; width: 100%; box-sizing: border-box;
    }
    .gericht-block, .beilage-block {
      background: #fff; padding: 10px; margin-top: 10px; border: 1px solid #ddd; border-radius: 6px; position: relative;
    }
    button {
      background-color: #E10600; color: white; border: none; padding: 10px 15px; cursor: pointer; margin-top: 10px;
    }
    .auftrag {
      background: white; padding: 15px; margin-top: 20px; border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1); position: relative;
    }
    .loeschen-btn {
      background: #d00; color: white; border: none; padding: 5px 10px; cursor: pointer;
      position: absolute; top: 10px; right: 10px;
    }
    .loeschen-inline {
      background: #999; color: white; border: none; padding: 4px 8px; cursor: pointer; margin-left: 10px;
    }
    .highlight {
      padding: 2px 6px; border-radius: 4px; display: inline-block; margin: 2px 0;
    }
  </style>
</head>
<body>

<h1>Partyservice Kleinfeldt – Auftragsplaner</h1>

<form id="auftragForm">
  <label>Kundenname</label>
  <input type="text" id="kunde" required>

  <label>Lieferdatum</label>
  <input type="date" id="datum" required>

  <label>Gesamtpersonen</label>
  <input type="number" id="personen" required>

  <div id="gerichteContainer"></div>
  <button type="button" onclick="addGericht()">+ Speise hinzufügen</button>

  <label>Lieferort</label>
  <input type="text" id="ort">

  <label>Lieferzeit</label>
  <input type="time" id="zeit">

  <label>Telefonnummer</label>
  <input type="tel" id="telefon">

  <label>Notizen</label>
  <textarea id="notizen" rows="3"></textarea>

  <button type="submit">Auftrag speichern</button>
</form>

<div id="auftragListe"></div>

<script>
  const speisen = [
    "Spanferkel", "BBQ Spanferkel", "Honigschinken", "Grillschinken", "Glasierte Pute", "Rinderbraten", "Kräuterbraten", "Gyrosbraten",
    "Griechischer Rahmbraten", "Spießbraten", "Altdeutscher Bierbraten", "Schweinefilet in Sahnesauce", "Kassler im Blätterteig", 
    "Bayrischer Leberkäse", "Grünkohl", "Wildschweinbraten", "Amerikanische Knabbereien", "Pulled Pork"
  ];

  const beilagen = [
    "Kartoffelgratin", "Röstkartoffeln", "Kartoffelspalten", "Kartoffelpüree", "Bratkartoffeln", "Salzkartoffeln", "Reis",
    "Geschmortes Kraut", "Bunte Gemüseauswahl", "Rotkohl",
    "Weißkrautsalat Natur", "Weißkrautsalat mit Yogurt", "Frischer gemischter Salat", "Eisberg-Melonen Salat", "Griechischer Salat",
    "Kartoffelsalat", "Speckkartoffelsalat", "Nudelsalat"
  ];

  const beilageGramm = {
    "Kartoffelgratin": 150, "Röstkartoffeln": 200, "Kartoffelspalten": 150, "Kartoffelpüree": 150,
    "Bratkartoffeln": 250, "Salzkartoffeln": 250, "Reis": 150,
    "Geschmortes Kraut": 150, "Bunte Gemüseauswahl": 200, "Rotkohl": 125,
    "Weißkrautsalat Natur": 150, "Weißkrautsalat mit Yogurt": 150, "Frischer gemischter Salat": 150,
    "Eisberg-Melonen Salat": 150, "Griechischer Salat": 150,
    "Kartoffelsalat": 150, "Speckkartoffelsalat": 150, "Nudelsalat": 150
  };

  const farben = ["#FFCCCC", "#CCFFCC", "#CCCCFF", "#FFE5CC", "#E5CCFF", "#CCFFFF", "#FFFFCC", "#FFCCE5", "#CCE5FF", "#E5FFCC"];

  function addGericht() {
    const container = document.getElementById("gerichteContainer");
    const div = document.createElement("div");
    div.className = "gericht-block";

    const speiseSelect = document.createElement("select");
    speisen.forEach(s => {
      const opt = document.createElement("option");
      opt.value = s;
      opt.text = s;
      speiseSelect.appendChild(opt);
    });

    const personenInput = document.createElement("input");
    personenInput.type = "number";
    personenInput.placeholder = "Personen für diese Speise";

    const beilagenDiv = document.createElement("div");

    const addBeilageBtn = document.createElement("button");
    addBeilageBtn.type = "button";
    addBeilageBtn.textContent = "+ Beilage hinzufügen";
    addBeilageBtn.onclick = function () {
      const bDiv = document.createElement("div");
      bDiv.className = "beilage-block";

      const bSelect = document.createElement("select");
      beilagen.forEach(b => {
        const opt = document.createElement("option");
        opt.value = b;
        opt.text = b;
        bSelect.appendChild(opt);
      });

      const pInput = document.createElement("input");
      pInput.type = "number";
      pInput.placeholder = "Personenanzahl für diese Beilage";

      const delB = document.createElement("button");
      delB.className = "loeschen-inline";
      delB.type = "button";
      delB.textContent = "Beilage löschen";
      delB.onclick = () => bDiv.remove();

      bDiv.appendChild(bSelect);
      bDiv.appendChild(pInput);
      bDiv.appendChild(delB);
      beilagenDiv.appendChild(bDiv);
    };

    const delG = document.createElement("button");
    delG.className = "loeschen-inline";
    delG.type = "button";
    delG.textContent = "Speise löschen";
    delG.onclick = () => div.remove();

    div.appendChild(document.createTextNode("Hauptspeise:"));
    div.appendChild(speiseSelect);
    div.appendChild(personenInput);
    div.appendChild(beilagenDiv);
    div.appendChild(addBeilageBtn);
    div.appendChild(delG);

    container.appendChild(div);
  }

  document.getElementById("auftragForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const kunde = document.getElementById("kunde").value;
    const datum = document.getElementById("datum").value;
    const personen = parseInt(document.getElementById("personen").value);
    const ort = document.getElementById("ort").value;
    const zeit = document.getElementById("zeit").value;
    const telefon = document.getElementById("telefon").value;
    const notizen = document.getElementById("notizen").value;

    const farbenMap = {};
    let farbCounter = 0;
    const beilageSummen = {};
    const hauptspeisenSummen = {};

    const gerichte = document.querySelectorAll(".gericht-block");
    gerichte.forEach(g => {
      const speise = g.querySelector("select").value;
      const pAnz = parseInt(g.querySelector("input").value);
      if (!hauptspeisenSummen[speise]) hauptspeisenSummen[speise] = 0;
      hauptspeisenSummen[speise] += pAnz;

      const bblocks = g.querySelectorAll(".beilage-block");
      bblocks.forEach(bb => {
        const b = bb.querySelector("select").value;
        const p = parseInt(bb.querySelector("input").value);
        if (!beilageSummen[b]) beilageSummen[b] = 0;
        beilageSummen[b] += p;
      });
    });

    const div = document.createElement("div");
    div.className = "auftrag";

    let hauptText = "<strong>Hauptspeisen:</strong><br>";
    for (const [gericht, p] of Object.entries(hauptspeisenSummen)) {
      const kg = (p * 250) / 1000;
      hauptText += `• ${gericht} (${p} P.) → ${kg.toFixed(2)} kg<br>`;
    }

    let beilageText = "<strong>Beilagen:</strong><br>";
    for (const [b, p] of Object.entries(beilageSummen)) {
      if (!farbenMap[b]) farbenMap[b] = farben[farbCounter++ % farben.length];
      const g = beilageGramm[b] || 150;
      const kg = (p * g) / 1000;
      beilageText += `<div class="highlight" style="background-color:${farbenMap[b]}">${b} (${p} P.) → ${kg.toFixed(2)} kg</div>`;
    }

    const loeschBtn = `<button class="loeschen-btn" onclick="this.parentElement.remove()">Auftrag löschen</button>`;

    div.innerHTML = `
      ${loeschBtn}
      <strong>${kunde}</strong><br>
      Datum: ${datum}<br>
      Gesamtpersonen: ${personen}<br><br>
      ${hauptText}<br>
      ${beilageText}<br>
      <br>Lieferzeit: ${zeit}<br>
      Ort: ${ort}<br>
      Telefon: ${telefon}<br>
      Notizen: ${notizen}
    `;

    document.getElementById("auftragListe").appendChild(div);
    this.reset();
    document.getElementById("gerichteContainer").innerHTML = "";
  });
</script>

</body>
</html>
