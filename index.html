
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Partyservice Kleinfeldt – Auftragsplaner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
      background-color: #f5f5f5;
    }
    header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    header img {
      height: 60px;
      margin-right: 15px;
    }
    h1 {
      color: #111;
      font-size: 1.8em;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      color: #222;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      margin-top: 10px;
      padding: 10px 15px;
      font-size: 15px;
      font-weight: bold;
      color: white;
      background-color: #E10600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #c00500;
    }
    .auftrag {
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 15px;
      margin-top: 20px;
      background: #fff;
      position: relative;
    }
    .loeschen-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #e00;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
    }
    .gericht-block, .beilage-block {
      border: 1px dashed #aaa;
      padding: 10px;
      margin-top: 10px;
      background: #fff;
      position: relative;
      border-radius: 5px;
    }
    .remove-block {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #aaa;
      color: white;
      border: none;
      padding: 3px 7px;
      cursor: pointer;
      font-size: 12px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Partyservice Kleinfeldt Logo">
    <h1>Partyservice Kleinfeldt – Auftragsplaner</h1>
  </header>

  <form id="auftragForm">
    <label>Kundenname</label>
    <input type="text" id="kunde" required>

    <label>Lieferdatum</label>
    <input type="date" id="datum" required>
    <p id="wochentag"></p>

    <label>Gesamtpersonen</label>
    <input type="number" id="personen" required>

    <div id="gerichteContainer"></div>
    <button type="button" onclick="addGerichtBlock()">+ Weitere Speise hinzufügen</button>

    <label>Lieferort</label>
    <input type="text" id="ort">

    <label>Lieferzeit</label>
    <input type="time" id="zeit">

    <label>Telefonnummer</label>
    <input type="tel" id="telefon">

    <label>Notizen</label>
    <textarea id="notizen" rows="3"></textarea>

    <button type="submit">Auftrag speichern</button>
  </form>

  <div id="auftragListe"></div>

  <script>
    const speisen = [
      "Spanferkel", "BBQ Spanferkel", "Honigschinken", "Grillschinken", "Glasierte Pute", "Rinderbraten", 
      "Kräuterbraten", "Gyrosbraten", "Griechischer Rahmbraten", "Spießbraten", "Altdeutscher Bierbraten", 
      "Schweinefilet in Sahnesauce", "Kassler im Blätterteig", "Bayrischer Leberkäse", "Grünkohl", 
      "Wildschweinbraten", "Amerikanische Knabbereien", "Pulled Pork"
    ];

    const beilagen = [
      "Kartoffelgratin", "Röstkartoffeln", "Kartoffelspalten", "Kartoffelpüree", "Bratkartoffeln",
      "Salzkartoffeln", "Reis", "Geschmortes Kraut", "Bunte Gemüseauswahl", "Rotkohl",
      "Weißkrautsalat Natur", "Weißkrautsalat mit Yogurt", "Frischer gemischter Salat",
      "Eisberg-Melonen Salat", "Griechischer Salat", "Kartoffelsalat",
      "Speckkartoffelsalat", "Nudelsalat"
    ];

    function addGerichtBlock() {
      const gerichtBlock = document.createElement("div");
      gerichtBlock.className = "gericht-block";
      gerichtBlock.innerHTML = `
        <button type="button" class="remove-block" onclick="this.parentElement.remove()">Speise entfernen</button>
        <label>Speise</label>
        <select name="gericht">
          ${speisen.map(s => `<option value="${s}">${s}</option>`).join("")}
        </select>
        <label>Personenanzahl für diese Speise</label>
        <input type="number" name="gericht_personen" required>
        <div class="beilagenContainer"></div>
        <button type="button" onclick="addBeilageBlock(this)">+ Beilage hinzufügen</button>
      `;
      document.getElementById("gerichteContainer").appendChild(gerichtBlock);
    }

    function addBeilageBlock(button) {
      const container = button.parentElement.querySelector(".beilagenContainer");
      const beilageBlock = document.createElement("div");
      beilageBlock.className = "beilage-block";
      beilageBlock.innerHTML = `
        <button type="button" class="remove-block" onclick="this.parentElement.remove()">Entfernen</button>
        <label>Beilage</label>
        <select name="beilage">
          ${beilagen.map(b => `<option value="${b}">${b}</option>`).join("")}
        </select>
        <label>Personenanzahl für diese Beilage</label>
        <input type="number" name="beilage_personen" required>
      `;
      container.appendChild(beilageBlock);
    }

    document.getElementById("auftragForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const totalPersonen = parseInt(document.getElementById("personen").value);
      const blocks = document.querySelectorAll(".gericht-block");
      let summe = 0;
      const gerichte = [];

      blocks.forEach(block => {
        const speise = block.querySelector("select[name='gericht']").value;
        const personen = parseInt(block.querySelector("input[name='gericht_personen']").value);
        summe += personen;

        const beilagen = Array.from(block.querySelectorAll(".beilage-block")).map(b => {
          const name = b.querySelector("select[name='beilage']").value;
          const p = b.querySelector("input[name='beilage_personen']").value;
          return `${name} (${p} P.)`;
        });

        gerichte.push(`${speise} (${personen} P.)<br>Beilagen: ${beilagen.join(", ")}`);
      });

      if (summe !== totalPersonen) {
        alert("Die Summe der Personen pro Speise stimmt nicht mit der Gesamtpersonenanzahl überein.");
        return;
      }

      const div = document.createElement("div");
      div.className = "auftrag";
      div.innerHTML = `
        <strong>${document.getElementById("kunde").value}</strong><br>
        Datum: ${document.getElementById("datum").value} (${new Date(document.getElementById("datum").value).toLocaleDateString("de-DE", { weekday: "long" })})<br>
        Gesamtpersonen: ${totalPersonen}<br>
        ${gerichte.map(g => "- " + g).join("<br><br>")}<br>
        Lieferzeit: ${document.getElementById("zeit").value}<br>
        Ort: ${document.getElementById("ort").value}<br>
        Telefon: ${document.getElementById("telefon").value}<br>
        Notizen: ${document.getElementById("notizen").value}<br>
        <button class="loeschen-btn">Löschen</button>
      `;

      div.querySelector(".loeschen-btn").addEventListener("click", () => {
        div.remove();
      });

      document.getElementById("auftragListe").appendChild(div);
      this.reset();
      document.getElementById("gerichteContainer").innerHTML = "";
      document.getElementById("wochentag").textContent = "";
      addGerichtBlock(); // Standardblock wieder anzeigen
    });

    document.getElementById("datum").addEventListener("change", (e) => {
      const tag = new Date(e.target.value).toLocaleDateString("de-DE", { weekday: "long" });
      document.getElementById("wochentag").textContent = `Wochentag: ${tag}`;
    });

    window.onload = () => addGerichtBlock();
  </script>
</body>
</html>
