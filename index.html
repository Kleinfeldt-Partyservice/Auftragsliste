
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Partyservice Kleinfeldt – Auftragsplaner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }
    h1 {
      color: #111;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    button {
      margin-top: 10px;
      padding: 10px 15px;
      font-size: 14px;
      background-color: #E10600;
      color: white;
      border: none;
      cursor: pointer;
    }
    .auftrag {
      background: white;
      padding: 15px;
      margin-top: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .loeschen-btn {
      float: right;
      background: #d00;
      color: white;
      border: none;
      padding: 4px 8px;
      cursor: pointer;
    }
    .highlight {
      padding: 2px 6px;
      border-radius: 4px;
      display: inline-block;
      margin: 2px 0;
    }
  </style>
</head>
<body>
  <h1>Partyservice Kleinfeldt – Auftragsplaner</h1>

  <form id="auftragForm">
    <label>Kundenname</label>
    <input type="text" id="kunde" required>

    <label>Lieferdatum</label>
    <input type="date" id="datum" required>
    <p id="wochentag"></p>

    <label>Gesamtpersonen</label>
    <input type="number" id="personen" required>

    <label>Beilagen und Personenanzahl (Mehrfach möglich)</label>
    <div id="beilagenContainer"></div>
    <button type="button" onclick="addBeilage()">+ Beilage hinzufügen</button>

    <label>Lieferort</label>
    <input type="text" id="ort">

    <label>Lieferzeit</label>
    <input type="time" id="zeit">

    <label>Telefonnummer</label>
    <input type="tel" id="telefon">

    <label>Notizen</label>
    <textarea id="notizen" rows="3"></textarea>

    <button type="submit">Auftrag speichern</button>
  </form>

  <div id="auftragListe"></div>

  <script>
    const beilageGramm = {
      "Kartoffelgratin": 150,
      "Röstkartoffeln": 200,
      "Kartoffelspalten": 150,
      "Kartoffelpüree": 150,
      "Bratkartoffeln": 250,
      "Salzkartoffeln": 250,
      "Reis": 150,
      "Geschmortes Kraut": 150,
      "Bunte Gemüseauswahl": 200,
      "Rotkohl": 125,
      "Weißkrautsalat Natur": 150,
      "Weißkrautsalat mit Yogurt": 150,
      "Frischer gemischter Salat": 150,
      "Eisberg-Melonen Salat": 150,
      "Griechischer Salat": 150,
      "Kartoffelsalat": 150,
      "Speckkartoffelsalat": 150,
      "Nudelsalat": 150
    };

    const farben = [
      "#FFCCCC", "#CCFFCC", "#CCCCFF", "#FFE5CC", "#E5CCFF", "#CCFFFF",
      "#FFFFCC", "#FFCCE5", "#CCE5FF", "#E5FFCC", "#FFD9B3", "#D9CCFF"
    ];

    const belegteFarben = {};
    const belegteMengen = {};

    function addBeilage() {
      const container = document.getElementById("beilagenContainer");
      const div = document.createElement("div");

      const select = document.createElement("select");
      for (const b in beilageGramm) {
        const option = document.createElement("option");
        option.value = b;
        option.text = b;
        select.appendChild(option);
      }

      const input = document.createElement("input");
      input.type = "number";
      input.placeholder = "Personenanzahl";

      div.appendChild(select);
      div.appendChild(input);
      container.appendChild(div);
    }

    document.getElementById("auftragForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const kunde = document.getElementById("kunde").value;
      const datum = document.getElementById("datum").value;
      const personen = parseInt(document.getElementById("personen").value);
      const ort = document.getElementById("ort").value;
      const zeit = document.getElementById("zeit").value;
      const telefon = document.getElementById("telefon").value;
      const notizen = document.getElementById("notizen").value;

      const div = document.createElement("div");
      div.className = "auftrag";

      const colorSammel = {};
      const container = document.getElementById("beilagenContainer");
      const children = container.querySelectorAll("div");

      children.forEach((child) => {
        const b = child.querySelector("select").value;
        const p = parseInt(child.querySelector("input").value);
        if (!colorSammel[b]) colorSammel[b] = 0;
        colorSammel[b] += p;
      });

      let farbIndex = 0;
      let beilageText = "";
      for (const [beilage, pSumme] of Object.entries(colorSammel)) {
        const gramm = beilageGramm[beilage] || 150;
        const gesamt = (pSumme * gramm) / 1000;
        const farbe = farben[farbIndex++ % farben.length];
        beilageText += `<div class="highlight" style="background-color:${farbe}">${beilage} (${pSumme} P.) → ${gesamt.toFixed(2)} kg</div>`;
      }

      div.innerHTML = `
        <button class="loeschen-btn" onclick="this.parentElement.remove()">Löschen</button>
        <strong>${kunde}</strong><br>
        Datum: ${datum}<br>
        Gesamtpersonen: ${personen}<br>
        ${beilageText}<br>
        Lieferzeit: ${zeit}<br>
        Ort: ${ort}<br>
        Telefon: ${telefon}<br>
        Notizen: ${notizen}
      `;

      document.getElementById("auftragListe").appendChild(div);
      this.reset();
      document.getElementById("beilagenContainer").innerHTML = "";
    });
  </script>
</body>
</html>
